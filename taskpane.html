<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Google Maps in Excel Add-in</title>
    <!-- Google Maps API script with your API key -->
    <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCS8L-j2sIfptPCLDUIMP3314KPrKq4394&callback=initMap" async defer></script>
    <script src="https://appsforoffice.microsoft.com/lib/1/hosted/office.js"></script> <!-- Excel JavaScript API -->
    <script>
        let map;
        
        // Initialize the map
        function initMap() {
            map = new google.maps.Map(document.getElementById('map'), {
                center: { lat: 37.7749, lng: -122.4194 }, // Default to San Francisco
                zoom: 10
            });

            // Add a click event listener to capture the clicked location's coordinates
            google.maps.event.addListener(map, 'click', function(event) {
                const lat = event.latLng.lat();
                const lng = event.latLng.lng();
                // Log the coordinates (for testing)
                console.log('Latitude:', lat, 'Longitude:', lng);

                // Insert coordinates into Excel
                insertCoordinatesIntoExcel(lat, lng);
            });
        }

        // Function to insert coordinates into Excel cells
        function insertCoordinatesIntoExcel(lat, lng) {
            Excel.run(function(context) {
                const sheet = context.workbook.worksheets.getActiveWorksheet();
                const cell1 = sheet.getRange("A1"); // Cell for Latitude
                const cell2 = sheet.getRange("B1"); // Cell for Longitude
                
                // Set values in Excel cells
                cell1.values = [[lat]];
                cell2.values = [[lng]];
                
                // Synchronize and commit changes to Excel
                return context.sync().then(function() {
                    console.log('Coordinates inserted into Excel:', lat, lng);
                });
            }).catch(function(error) {
                console.error('Error inserting coordinates:', error);
            });
        }
    </script>
</head>
<body>
    <!-- Embed Google Maps in a div -->
    <div id="map" style="width: 100%; height: 100vh;"></div>
</body>
</html>
